/*
THIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT ("AGREEMENT") LOCATED HERE:
https://www.infragistics.com/legal/license/igultimate-la
https://www.infragistics.com/legal/license/igultimate-eula
GOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.
*/
import { Base, markType, INotifyPropertyChanged_$type, PropertyChangedEventArgs, Array_$type, enumGetBox, EnumUtil, typeGetValue, Number_$type, String_$type, fromEnum, typeCast, Date_$type, markDep, runOn, TypeRegistrar } from "igniteui-react-core";
import { List$1 } from "igniteui-react-core";
import { DataAbbreviationMode_$type } from "igniteui-react-core";
import { Brush } from "igniteui-react-core";
import { FontInfo } from "igniteui-react-core";
import { Thickness } from "igniteui-react-core";
import { Size } from "igniteui-react-core";
import { Rect } from "igniteui-react-core";
import { stringIsNullOrEmpty, stringEmpty, stringContains } from "igniteui-react-core";
import { DataLegendSeriesContext } from "igniteui-react-core";
import { LegendItemBadgeShape_$type } from "igniteui-react-core";
import { Control } from "igniteui-react-core";
import { IDataLegend_$type } from "igniteui-react-core";
import { IOnDemandRender_$type } from "igniteui-react-core";
import { DependencyProperty } from "igniteui-react-core";
import { DataLegendValueMode_$type } from "igniteui-react-core";
import { FontUtil } from "igniteui-react-core";
import { DataLegendHeaderDateMode_$type } from "igniteui-react-core";
import { DataLegendHeaderTimeMode_$type } from "igniteui-react-core";
import { DataLegendSummaryType_$type } from "igniteui-react-core";
import { DataLegendUnitsMode_$type } from "igniteui-react-core";
import { DataLegendLabelMode_$type } from "igniteui-react-core";
import { BindingFormatter } from "igniteui-react-core";
import { DataLegendVisualData } from "./DataLegendVisualData";
import { Extensions } from "igniteui-react-core";
import { TextBlock } from "igniteui-react-core";
import { DataLegendVisualDataRow } from "./DataLegendVisualDataRow";
import { DataLegendVisualDataColumn } from "./DataLegendVisualDataColumn";
import { RectData } from "igniteui-react-core";
import { AppearanceHelper } from "igniteui-react-core";
import { FrameworkElement } from "igniteui-react-core";
import { DataLegendSummaryEventArgs } from "./DataLegendSummaryEventArgs";
import { DataLegendSummaryCalculationTotal } from "./DataLegendSummaryCalculationTotal";
import { DataLegendSummaryCalculationAverage } from "./DataLegendSummaryCalculationAverage";
import { DataLegendSummaryCalculationMin } from "./DataLegendSummaryCalculationMin";
import { DataLegendSummaryCalculationMax } from "./DataLegendSummaryCalculationMax";
import { DataLegendSummaryCalculationEmpty } from "./DataLegendSummaryCalculationEmpty";
import { DataLegendStylingRowEventArgs } from "./DataLegendStylingRowEventArgs";
import { DataLegendStylingColumnEventArgs } from "./DataLegendStylingColumnEventArgs";
import { Dictionary$2 } from "igniteui-react-core";
import { IDataLegendSeries_$type } from "igniteui-react-core";
import { DataLegendSeriesGroupInfo } from "./DataLegendSeriesGroupInfo";
import { RenderingContext } from "igniteui-react-core";
import { DataLegendRenderContext } from "./DataLegendRenderContext";
import { Pool$1 } from "igniteui-react-core";
import { ContentControl } from "igniteui-react-core";
import { DataLegendSeriesValueInfo } from "igniteui-react-core";
import { DataLegendColumn } from "./DataLegendColumn";
import { DataLegendSummaryColumn } from "igniteui-react-core";
import { DataAbbreviator } from "./DataAbbreviator";
import { NumberFormatSpecifier } from "igniteui-react-core";
import { DateTimeFormatSpecifier } from "igniteui-react-core";
import { PropertyMetadata } from "igniteui-react-core";
import { isNaN_, isInfinity, truncate } from "igniteui-react-core";
import { numberToString2 } from "igniteui-react-core";
import { EventProxy } from "igniteui-react-core";
import { Tuple$2 } from "igniteui-react-core";
import { CanvasViewRenderer } from "igniteui-react-core";
import { DataTemplatePassInfo } from "igniteui-react-core";
import { DataTemplateMeasureInfo } from "igniteui-react-core";
import { DataTemplateRenderInfo } from "igniteui-react-core";
import { FontDefaults } from "igniteui-react-core";
/**
 * @hidden
 */
export let DataLegendContent = /*@__PURE__*/ (() => {
    class DataLegendContent extends Base {
        constructor() {
            super(...arguments);
            this.a = new List$1(DataLegendRowInfo.$, 0);
            this.d = 0;
            this.c = 0;
        }
        get b() {
            return this.a;
        }
        f() {
            this.b.clear();
        }
        e(a) {
            this.b.add(a);
        }
    }
    DataLegendContent.$t = /*@__PURE__*/ markType(DataLegendContent, 'DataLegendContent');
    return DataLegendContent;
})();
/**
 * @hidden
 */
export let DataLegendRowBase = /*@__PURE__*/ (() => {
    class DataLegendRowBase extends Base {
        constructor(a, b, c, d, e) {
            super();
            this.f = 0;
            this.c = false;
            this.e = false;
            this.a = false;
            this.b = false;
            this.d = false;
            this.f = e;
            this.e = b;
            this.b = c;
            this.a = d;
            this.d = !c && !b && !d;
            this.c = true;
        }
    }
    DataLegendRowBase.$t = /*@__PURE__*/ markType(DataLegendRowBase, 'DataLegendRowBase');
    return DataLegendRowBase;
})();
/**
 * @hidden
 */
export let DataLegendRowCell = /*@__PURE__*/ (() => {
    class DataLegendRowCell extends DataLegendRowBase {
        constructor(a, b, c, d, e) {
            super(a, b, c, d, e);
            this.t = 0;
            this.g = 0;
            this.s = 0;
            this.x = null;
            this.w = null;
            this.u = null;
            this.y = null;
            this.v = null;
            this.aa = null;
            this.ab = null;
            this.ac = null;
            this.h = null;
            this.j = null;
            this.i = null;
            this.am = null;
            this.ao = null;
            this.an = null;
            this.ah = new Size();
            this.al = new Size();
            this.aj = new Size();
            this.n = false;
            this.k = false;
            this.ad = null;
            this.af = null;
            this.ae = null;
            this.ag = new Size();
            this.ak = new Size();
            this.ai = new Size();
            this.s = NaN;
            this.am = new Thickness(0, 0);
            this.ao = new Thickness(0, 0);
            this.an = new Thickness(0, 0);
            this.ah = new Size(1, 0, 0);
            this.al = new Size(1, 0, 0);
            this.aj = new Size(1, 0, 0);
            this.n = true;
            this.k = true;
            if (this.d) {
                this.aa = a.bw();
                this.ac = a.by();
                this.ab = a.bx();
                this.h = a.l();
                this.j = a.p();
                this.i = a.o();
            }
            else if (this.e) {
                let f = a.bv();
                let g = a.m();
                this.aa = f;
                this.ac = f;
                this.ab = f;
                this.h = g;
                this.j = g;
                this.i = g;
            }
            else if (this.a) {
                let h = a.bs();
                let i = a.j();
                this.aa = h;
                this.ac = h;
                this.ab = h;
                this.h = i;
                this.j = i;
                this.i = i;
            }
            else {
                let j = a.bt();
                let k = a.k();
                this.aa = j;
                this.ac = j;
                this.ab = j;
                this.h = k;
                this.j = k;
                this.i = k;
            }
            this.ad = Rect.empty;
            this.af = Rect.empty;
            this.ae = Rect.empty;
        }
        l() {
            return this.ah.width > 0 && this.ah.height > 0;
        }
        o() {
            return this.aj.width > 0 && this.aj.height > 0;
        }
        q() {
            return this.al.width > 0 && this.al.height > 0;
        }
        m() {
            return this.u != null;
        }
        p() {
            return this.v != null;
        }
        r() {
            return !stringIsNullOrEmpty(this.y) && this.al.width > 0 && this.al.height > 0;
        }
        z() {
            this.ag = new Size(1, 0, 0);
            this.ak = new Size(1, 0, 0);
            this.ai = new Size(1, 0, 0);
        }
    }
    DataLegendRowCell.$t = /*@__PURE__*/ markType(DataLegendRowCell, 'DataLegendRowCell', DataLegendRowBase.$);
    return DataLegendRowCell;
})();
/**
 * @hidden
 */
export let DataLegendRowInfo = /*@__PURE__*/ (() => {
    class DataLegendRowInfo extends DataLegendRowBase {
        r(a) {
            if (this.l == null) {
                return;
            }
            for (let b = 0; b < this.l.count; b++) {
                a(this.l._inner[b]);
            }
        }
        constructor(a, b, c, d, e) {
            super(a, b, c, d, e);
            this.l = null;
            this.k = false;
            this.p = null;
            this.g = null;
            this.h = null;
            this.q = null;
            this.t = null;
            this.j = null;
            this.x = new Size();
            this.aa = null;
            this.o = null;
            this.s = null;
            this.w = new Size();
            this.m = null;
            this.i = 0;
            this.n = null;
            this.z = null;
            this.y = null;
            this.u = null;
            this.v = null;
            this.g = new Array(0);
            this.l = new List$1(DataLegendRowCell.$, 0);
            this.k = this.d;
            this.z = new Thickness(0, 0);
            this.y = new Thickness(0, 0);
            this.aa = new Thickness(0, 0);
            this.w = new Size(1, 0, 0);
            this.x = new Size(1, 0, 0);
            if (this.d) {
                this.t = a.bw();
                this.j = a.n();
            }
            else if (this.e) {
                let f = a.bv();
                let g = a.m();
                this.t = f;
                this.j = g;
            }
            else if (this.a) {
                let h = a.bs();
                let i = a.j();
                this.t = h;
                this.j = i;
            }
            else {
                let j = a.bt();
                let k = a.k();
                this.t = j;
                this.j = k;
            }
            this.v = Rect.empty;
            this.u = Rect.empty;
            this.i = 7;
            this.n = "None";
        }
    }
    DataLegendRowInfo.$t = /*@__PURE__*/ markType(DataLegendRowInfo, 'DataLegendRowInfo', DataLegendRowBase.$);
    return DataLegendRowInfo;
})();
/**
 * @hidden
 */
export let XamDataLegend = /*@__PURE__*/ (() => {
    class XamDataLegend extends Control {
        get co() {
            return this.ck;
        }
        set co(a) {
            let b = this.ck;
            this.ck = a;
            if (b != this.ck) {
                this.f7("ActualCursorPositionX", b, this.ck);
            }
        }
        get cp() {
            return this.cl;
        }
        set cp(a) {
            let b = this.cl;
            this.cl = a;
            if (b != this.cl) {
                this.f7("ActualCursorPositionY", b, this.cl);
            }
        }
        get cq() {
            return this.cm;
        }
        set cq(a) {
            let b = this.cm;
            this.cm = a;
            this.f7("ActualPixelScalingRatio", b, this.cm);
        }
        get bw() {
            return this.bl;
        }
        set bw(a) {
            let b = this.bl;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.p();
            }
            this.bl = a;
            if (b != this.bl) {
                this.f7("ValueTextStyle", b, this.bl);
            }
        }
        get bo() {
            return this.bd;
        }
        set bo(a) {
            let b = this.bd;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.k();
            }
            this.bd = a;
            if (b != this.bd) {
                this.f7("HeaderTextStyle", b, this.bd);
            }
        }
        get bn() {
            return this.bc;
        }
        set bn(a) {
            let b = this.bc;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.j();
            }
            this.bc = a;
            if (b != this.bc) {
                this.f7("GroupTextStyle", b, this.bc);
            }
        }
        get br() {
            return this.bg;
        }
        set br(a) {
            let b = this.bg;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.m();
            }
            this.bg = a;
            if (b != this.bg) {
                this.f7("SummaryTitleTextStyle", b, this.bg);
            }
        }
        get bt() {
            return this.bi;
        }
        set bt(a) {
            let b = this.bi;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.p();
            }
            this.bi = a;
            if (b != this.bi) {
                this.f7("SummaryValueTextStyle", b, this.bi);
            }
        }
        get bq() {
            return this.bf;
        }
        set bq(a) {
            let b = this.bf;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.l();
            }
            this.bf = a;
            if (b != this.bf) {
                this.f7("SummaryLabelTextStyle", b, this.bf);
            }
        }
        get bs() {
            return this.bh;
        }
        set bs(a) {
            let b = this.bh;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.o();
            }
            this.bh = a;
            if (b != this.bh) {
                this.f7("SummaryUnitsTextStyle", b, this.bh);
            }
        }
        get bv() {
            return this.bk;
        }
        set bv(a) {
            let b = this.bk;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.o();
            }
            this.bk = a;
            if (b != this.bk) {
                this.f7("UnitsTextStyle", b, this.bk);
            }
        }
        get bu() {
            return this.bj;
        }
        set bu(a) {
            let b = this.bj;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.n();
            }
            this.bj = a;
            if (b != this.bj) {
                this.f7("TitleTextStyle", b, this.bj);
            }
        }
        get bp() {
            return this.be;
        }
        set bp(a) {
            let b = this.be;
            if (typeof a === 'string') {
                a = FontUtil.getFontInfoFromString(this.a6.al, a);
            }
            else if (a == null || a.c()) {
                a = this.a6.l();
            }
            this.be = a;
            if (b != this.be) {
                this.f7("LabelTextStyle", b, this.be);
            }
        }
        get pixelScalingRatio() {
            return this.cn;
        }
        set pixelScalingRatio(a) {
            let b = this.cn;
            this.cn = a;
            this.f7("PixelScalingRatio", b, this.cn);
        }
        exportSerializedVisualData() {
            let a = this.exportVisualData();
            return a.serialize();
        }
        cs(a, b) {
            let c = Math.max(b.left, a);
            let d = Math.max(b.right, a);
            let e = Math.max(b.right, a);
            return Math.min(b.top, a);
        }
        cr(a, b) {
            return Math.min(b.left, a);
        }
        is(a, b) {
            let c = Rect.l_op_Equality(a, null) || a.isEmpty || !Extensions.b(a);
            let d = Rect.l_op_Equality(b, null) || b.isEmpty || !Extensions.b(b);
            if (c) {
                return b;
            }
            if (d) {
                return a;
            }
            if (c && c) {
                return Rect.empty;
            }
            let e = Math.min(a.top, b.top);
            let f = Math.min(a.left, b.left);
            let g = Math.max(a.right, b.right);
            let h = Math.max(a.bottom, b.bottom);
            return new Rect(0, f, e, g - f, h - e);
        }
        exportVisualData() {
            let a = new DataLegendVisualData();
            a.width = this.ao.d;
            a.height = this.ao.c;
            if (this.a6 == null) {
                return a;
            }
            let b = -1;
            let c = -1;
            let d = -1;
            let e = -1;
            let f = this.a6.af;
            let g = this.a6.ad;
            let h = this.a6.ah;
            let i = this.a6.ag;
            if (f.count < this.ao.b.count) {
                return a;
            }
            if (Rect.l_op_Equality(this.it, null) || this.it.isEmpty) {
                a.viewport = null;
            }
            else {
                a.viewport = new RectData(0, 0, this.it.width, this.it.height);
            }
            for (let j = 0; j < this.ao.b.count; j++) {
                let k = this.ao.b._inner[j];
                let l = new DataLegendVisualDataRow();
                l.seriesIndex = k.f;
                l.rowMarginTop = k.z.top;
                l.rowMarginBottom = k.z.bottom;
                l.rowMarginRight = k.z.right;
                l.rowMarginLeft = k.z.left;
                let m = Rect.empty;
                if (k.c) {
                    if (Extensions.b(k.v) && f.count > (b + 1)) {
                        b++;
                        let n = f._inner[b];
                        let o = this.bm(n, k.j);
                        let p = new DataLegendVisualDataColumn();
                        p.bounds = RectData.b(k.v);
                        p.text = n.al;
                        p.textColor = AppearanceHelper.b(k.t);
                        p.marginTop = k.aa.top;
                        p.marginLeft = k.aa.left;
                        p.marginRight = k.aa.right;
                        p.marginBottom = k.aa.bottom;
                        this.gh(p, o);
                        l.columns.add(p);
                        m = this.is(m, k.v);
                    }
                    for (let q of fromEnum(k.l)) {
                        if (Extensions.b(q.ad) && g.count > (c + 1)) {
                            c++;
                            let r = g._inner[c];
                            let s = this.bm(r, q.h);
                            let t = new DataLegendVisualDataColumn();
                            t.bounds = RectData.b(q.ad);
                            t.text = r.al;
                            t.textColor = AppearanceHelper.b(q.aa);
                            t.marginTop = q.am.top;
                            t.marginLeft = q.am.left;
                            t.marginRight = q.am.right;
                            t.marginBottom = q.am.bottom;
                            this.gh(t, s);
                            l.columns.add(t);
                            m = this.is(m, q.ad);
                        }
                        if (Extensions.b(q.af) && h.count > (d + 1)) {
                            d++;
                            let u = h._inner[d];
                            let v = this.bm(u, q.j);
                            let w = new DataLegendVisualDataColumn();
                            w.bounds = RectData.b(q.af);
                            w.text = u.al;
                            w.textColor = AppearanceHelper.b(q.ac);
                            w.marginTop = q.ao.top;
                            w.marginLeft = q.ao.left;
                            w.marginRight = q.ao.right;
                            w.marginBottom = q.ao.bottom;
                            this.gh(w, v);
                            l.columns.add(w);
                            m = this.is(m, q.af);
                        }
                        if (Extensions.b(q.ae) && i.count > (e + 1)) {
                            e++;
                            let x = i._inner[e];
                            let y = this.bm(x, q.i);
                            let z = new DataLegendVisualDataColumn();
                            z.bounds = RectData.b(q.ae);
                            z.text = q.n ? q.v : null;
                            z.textColor = AppearanceHelper.b(q.ab);
                            z.marginTop = q.an.top;
                            z.marginLeft = q.an.left;
                            z.marginRight = q.an.right;
                            z.marginBottom = q.an.bottom;
                            this.gh(z, y);
                            l.columns.add(z);
                            m = this.is(m, q.ae);
                        }
                    }
                    if (k.k) {
                        m = this.is(m, k.u);
                        l.badgeBounds = RectData.b(k.u);
                        l.badgeMarginTop = k.y.top;
                        l.badgeMarginBottom = k.y.bottom;
                        l.badgeMarginRight = k.y.right;
                        l.badgeMarginLeft = k.y.left;
                        l.badgeShape = k.n;
                    }
                    l.rowBounds = RectData.b(m);
                }
                a.rows.add(l);
            }
            return a;
        }
        gh(a, b) {
            if (b != null) {
                if (b.q != null) {
                    a.fontFamily = b.q;
                }
                if (!isNaN_(b.f)) {
                    a.fontSize = b.f;
                }
                a.fontWeight = stringIsNullOrEmpty(b.v) ? "Normal" : b.v;
                a.fontStyle = stringIsNullOrEmpty(b.t) ? "Normal" : b.t;
                if (b.r != null) {
                    a.fontStretch = b.t;
                }
            }
        }
        bm(a, b) {
            let c = a.dataContext;
            if (c != null) {
                b = a.dataContext;
            }
            if (b == null || stringIsNullOrEmpty(b.fontString)) {
                return b;
            }
            else {
                return FontUtil.toFontInfo(this.a6.al, b.fontString);
            }
        }
        a1(a) {
            if (this.calculateColumnSummary != null) {
                let b = new DataLegendSummaryEventArgs(a.a, a.d);
                b.summaryValue = a.c;
                this.calculateColumnSummary(this, b);
                a.c = b.summaryValue;
                a.f = b.summaryUnits;
                a.e = b.summaryLabel;
            }
            return a;
        }
        a7() {
            switch (this.a2) {
                case 0:
                case 1: return new DataLegendSummaryCalculationTotal();
                case 2: return new DataLegendSummaryCalculationAverage();
                case 3: return new DataLegendSummaryCalculationMin();
                case 4: return new DataLegendSummaryCalculationMax();
                case 5: return new DataLegendSummaryCalculationEmpty();
                default: return new DataLegendSummaryCalculationEmpty();
            }
        }
        gm(a) {
            if (this.styleSummaryRow != null) {
                let b = this.az(a);
                this.styleSummaryRow(this, b);
                this.gi(a, b);
            }
            if (a.c && a.l != null && this.styleSummaryColumn != null) {
                for (let c = 0; c < a.l.count; c++) {
                    let d = this.ay(a.l._inner[c]);
                    d.d = a.f;
                    d.g = a.p;
                    d.c = c;
                    d.e = a.o;
                    this.styleSummaryColumn(this, d);
                    this.gn(a.l._inner[c], d);
                }
            }
        }
        gl(a) {
            if (this.styleSeriesRow != null) {
                let b = this.az(a);
                this.styleSeriesRow(this, b);
                this.gi(a, b);
            }
            if (a.c && a.l != null && this.styleSeriesColumn != null) {
                for (let c = 0; c < a.l.count; c++) {
                    let d = this.ay(a.l._inner[c]);
                    d.d = a.f;
                    d.g = a.p;
                    d.c = c;
                    d.e = a.o;
                    this.styleSeriesColumn(this, d);
                    this.gn(a.l._inner[c], d);
                }
            }
        }
        gk(a) {
            if (this.styleHeaderRow != null) {
                let b = this.az(a);
                this.styleHeaderRow(this, b);
                this.gi(a, b);
            }
        }
        gj(a) {
            if (this.styleGroupRow != null) {
                let b = this.az(a);
                this.styleGroupRow(this, b);
                this.gi(a, b);
            }
        }
        az(a) {
            let b = new DataLegendStylingRowEventArgs();
            b.g = a.q;
            b.h = a.t;
            b.e = a.o;
            b.a = a.i;
            b.b = a.k;
            b.c = a.c;
            b.d = a.f;
            b.f = a.p;
            return b;
        }
        gi(a, b) {
            a.q = b.g;
            a.t = b.h;
            a.i = b.a;
            a.k = b.b;
            a.c = b.c;
        }
        ay(a) {
            let b = new DataLegendStylingColumnEventArgs();
            b.f = a.u;
            b.l = a.aa;
            b.h = a.v;
            b.m = a.ab;
            b.k = a.y;
            b.n = a.ac;
            b.b = a.s;
            b.j = a.x;
            b.i = a.w;
            b.a = a.g;
            return b;
        }
        gn(a, b) {
            a.aa = b.l;
            a.u = b.f;
            a.k = !stringIsNullOrEmpty(a.u);
            a.v = b.h;
            a.ab = b.m;
            a.n = !stringIsNullOrEmpty(a.v);
            a.y = b.k;
            a.ac = b.n;
        }
        ga(a, b, c) {
            switch (a) {
                case XamDataLegend.$$p[23]:
                    this.b0 = c;
                    break;
                case XamDataLegend.$$p[19]:
                case XamDataLegend.$$p[3]:
                    this.gr();
                    break;
                case XamDataLegend.$$p[18]:
                case XamDataLegend.$$p[2]:
                    this.gq();
                    break;
                case XamDataLegend.$$p[36]:
                    let d = c;
                    let e = b;
                    this.f8(e, d);
                    break;
                case XamDataLegend.$$p[34]:
                    if (this.b5(this.targetCursorPositionX)) {
                        this.co = this.targetCursorPositionX;
                    }
                    break;
                case XamDataLegend.$$p[35]:
                    if (this.b5(this.targetCursorPositionY)) {
                        this.cp = this.targetCursorPositionY;
                    }
                    break;
                case XamDataLegend.$$p[50]:
                case XamDataLegend.$$p[49]:
                    if (!stringIsNullOrEmpty(this.fc)) {
                        this.ak = ((() => {
                            let $ret = new BindingFormatter();
                            $ret.j = this.fc;
                            $ret.d = this.ah;
                            return $ret;
                        })());
                    }
                    else {
                        this.ak = null;
                    }
                    break;
                case XamDataLegend.$$p[11]:
                case XamDataLegend.$$p[10]:
                    if (!stringIsNullOrEmpty(this.dk)) {
                        this.ai = ((() => {
                            let $ret = new BindingFormatter();
                            $ret.j = this.dk;
                            $ret.d = this.ag;
                            return $ret;
                        })());
                    }
                    else {
                        this.ai = null;
                    }
                    break;
                case "PixelScalingRatio":
                    if (isNaN_(this.cq)) {
                        this.a6.ay();
                    }
                    else {
                        this.cq = this.pixelScalingRatio;
                    }
                    break;
                case "ActualPixelScalingRatio":
                    this.a6.a9(c);
                    break;
            }
            this.gc();
        }
        f7(a, b, c) {
            this.ga(a, b, c);
            if (this.propertyChanged != null) {
                this.propertyChanged(this, new PropertyChangedEventArgs(a));
            }
        }
        f8(a, b) {
            this.a8 = b;
            if (a != null) {
                a.detachDataLegend(this);
            }
            if (b != null) {
                b.attachDataLegend(this);
                if (isNaN_(this.targetCursorPositionX)) {
                    this.co = -1;
                }
                if (isNaN_(this.targetCursorPositionY)) {
                    this.cp = -1;
                }
            }
        }
        gr() {
            this.cf = this.cg(this.includedSeries);
            this.ce = this.cg(this.excludedSeries);
        }
        gq() {
            this.cc = this.cg(this.includedColumns);
            this.cb = this.cg(this.excludedColumns);
            if (this.cc != null) {
                let a = new List$1(String_$type, 1, this.cc.keys);
                for (let b of fromEnum(a)) {
                    let c = b + ":";
                    let d = this.cc.item(b);
                    if (!this.cc.containsKey(c)) {
                        this.cc.addItem(c, d);
                    }
                }
                this.fo(this.cc);
            }
            if (this.cb != null) {
                let e = new List$1(String_$type, 1, this.cb.keys);
                for (let f of fromEnum(e)) {
                    let g = f + ":";
                    let h = this.cb.item(f);
                    if (!this.cb.containsKey(g)) {
                        this.cb.addItem(g, h);
                    }
                }
                this.fo(this.cb);
            }
        }
        fo(a) {
            let b = new List$1(String_$type, 1, a.keys);
            for (let c of fromEnum(b)) {
                let d = a.item(c);
                let e = c.toLowerCase();
                if (!a.containsKey(e)) {
                    a.addItem(e, d);
                }
                let f = c.toUpperCase();
                if (!a.containsKey(f)) {
                    a.addItem(f, d);
                }
                if (c.length > 0) {
                    let g = f.substr(0, 1) + e.substr(1);
                    if (!a.containsKey(g)) {
                        a.addItem(g, d);
                    }
                }
            }
        }
        cg(a) {
            if (a == null) {
                return null;
            }
            let b = new Dictionary$2(String_$type, Number_$type, 0);
            for (let c = 0; c < a.length; c++) {
                let d = a[c];
                if (!stringIsNullOrEmpty(d) && !b.containsKey(d.trim())) {
                    b.addItem(d.trim(), b.count);
                }
            }
            return b;
        }
        b5(a) {
            return a >= 0 && a <= 1;
        }
        notifyCursorPositionChanged(a) {
            let b = !isNaN_(this.targetCursorPositionX) || !isNaN_(this.targetCursorPositionY);
            let c = !isNaN_(a.x) && this.b5(a.x);
            let d = !isNaN_(a.y) && this.b5(a.y);
            if (!b && c && d) {
                this.co = a.x;
                this.cp = a.y;
            }
        }
        notifySizeChanged() {
            this.a6.a7();
        }
        notifyVisualPropertiesChanged(a) {
        }
        notifySeriesCollectionChanged() {
            this.gc();
        }
        notifySeriesDataChanged() {
            if (this.b0) {
                this.gc();
            }
        }
        constructor() {
            super();
            this.bz = false;
            this.ck = NaN;
            this.cl = NaN;
            this.cm = 1;
            this.b0 = false;
            this.bl = null;
            this.bd = null;
            this.bc = null;
            this.bg = null;
            this.bi = null;
            this.bf = null;
            this.bh = null;
            this.a8 = null;
            this.bk = null;
            this.bj = null;
            this.be = null;
            this.cn = NaN;
            this.calculateColumnSummary = null;
            this.styleHeaderRow = null;
            this.styleGroupRow = null;
            this.styleSeriesRow = null;
            this.styleSummaryRow = null;
            this.styleSeriesColumn = null;
            this.styleSummaryColumn = null;
            this.propertyChanged = null;
            this.cc = null;
            this.cb = null;
            this.cf = null;
            this.ce = null;
            this.a6 = null;
            this.it = null;
            this._externalObject = null;
            this.bx = false;
            this.by = false;
            this.cj = null;
            this.cd = new Dictionary$2(String_$type, DataLegendSeriesGroupInfo.$, 0);
            this.ao = new DataLegendContent();
            this.cu = 0;
            this.ak = null;
            this.al = null;
            this.c0 = "";
            this.ai = null;
            this.aj = null;
            this.it = Rect.empty;
            this.b0 = true;
            this.ab = XamDataLegend.$;
            this.a6 = this.a5();
        }
        updatePropertyByName(a, b) {
            switch (a) {
                case XamDataLegend.$$p[19]:
                    this.includedSeries = b;
                    break;
                case XamDataLegend.$$p[3]:
                    this.excludedSeries = b;
                    break;
                case XamDataLegend.$$p[18]:
                    this.includedColumns = b;
                    break;
                case XamDataLegend.$$p[2]:
                    this.excludedColumns = b;
                    break;
                case XamDataLegend.$$p[43]:
                    this.an = EnumUtil.getEnumValue(DataAbbreviationMode_$type, b);
                    break;
                case XamDataLegend.$$p[46]:
                    this.cw = typeGetValue(b);
                    break;
                case XamDataLegend.$$p[47]:
                    this.cx = typeGetValue(b);
                    break;
                case XamDataLegend.$$p[48]:
                    this.a4 = EnumUtil.getEnumValue(DataLegendValueMode_$type, b);
                    break;
                case XamDataLegend.$$p[44]:
                    this.e4 = b;
                    break;
                case XamDataLegend.$$p[51]:
                    this.b8 = b;
                    break;
                case XamDataLegend.$$p[50]:
                    this.fc = b;
                    break;
                case XamDataLegend.$$p[49]:
                    this.ah = b;
                    break;
                case XamDataLegend.$$p[52]:
                    this.i9 = b;
                    break;
                case XamDataLegend.$$p[53]:
                    this.b9 = b;
                    break;
                case XamDataLegend.$$p[57]:
                    this.fl = b;
                    break;
                case XamDataLegend.$$p[56]:
                    this.ca = b;
                    break;
                case XamDataLegend.$$p[55]:
                    this.ja = b;
                    break;
                case XamDataLegend.$$p[54]:
                    this.ir = b;
                    break;
                case "ValueTextStyle":
                    this.bw = b;
                    break;
                case XamDataLegend.$$p[11]:
                    this.dk = b;
                    break;
                case XamDataLegend.$$p[10]:
                    this.ag = b;
                    break;
                case XamDataLegend.$$p[8]:
                    this.dg = b;
                    break;
                case XamDataLegend.$$p[9]:
                    this.ap = EnumUtil.getEnumValue(DataLegendHeaderDateMode_$type, b);
                    break;
                case XamDataLegend.$$p[12]:
                    this.aq = EnumUtil.getEnumValue(DataLegendHeaderTimeMode_$type, b);
                    break;
                case XamDataLegend.$$p[17]:
                    this.dq = b;
                    break;
                case XamDataLegend.$$p[15]:
                    this.ih = b;
                    break;
                case XamDataLegend.$$p[16]:
                    this.i2 = b;
                    break;
                case XamDataLegend.$$p[13]:
                    this.i1 = b;
                    break;
                case XamDataLegend.$$p[14]:
                    this.b4 = b;
                    break;
                case "HeaderTextStyle":
                    this.bo = b;
                    break;
                case XamDataLegend.$$p[6]:
                    this.ig = b;
                    break;
                case XamDataLegend.$$p[7]:
                    this.i0 = b;
                    break;
                case XamDataLegend.$$p[4]:
                    this.iz = b;
                    break;
                case XamDataLegend.$$p[5]:
                    this.b2 = b;
                    break;
                case "GroupTextStyle":
                    this.bn = b;
                    break;
                case XamDataLegend.$$p[27]:
                    this.il = b;
                    break;
                case "SummaryTitleTextStyle":
                    this.br = b;
                    break;
                case XamDataLegend.$$p[30]:
                    this.a2 = EnumUtil.getEnumValue(DataLegendSummaryType_$type, b);
                    break;
                case XamDataLegend.$$p[29]:
                    this.ef = b;
                    break;
                case XamDataLegend.$$p[28]:
                    this.i5 = b;
                    break;
                case XamDataLegend.$$p[26]:
                    this.i4 = b;
                    break;
                case XamDataLegend.$$p[33]:
                    this.io = b;
                    break;
                case "SummaryValueTextStyle":
                    this.bt = b;
                    break;
                case XamDataLegend.$$p[25]:
                    this.ea = b;
                    break;
                case XamDataLegend.$$p[24]:
                    this.ik = b;
                    break;
                case "SummaryLabelTextStyle":
                    this.bq = b;
                    break;
                case XamDataLegend.$$p[32]:
                    this.el = b;
                    break;
                case XamDataLegend.$$p[31]:
                    this.im = b;
                    break;
                case "SummaryUnitsTextStyle":
                    this.bs = b;
                    break;
                case XamDataLegend.$$p[0]:
                    this.iy = b;
                    break;
                case XamDataLegend.$$p[1]:
                    this.a9 = EnumUtil.getEnumValue(LegendItemBadgeShape_$type, b);
                    break;
                case XamDataLegend.$$p[39]:
                    this.a3 = EnumUtil.getEnumValue(DataLegendUnitsMode_$type, b);
                    break;
                case XamDataLegend.$$p[42]:
                    this.ey = b;
                    break;
                case XamDataLegend.$$p[40]:
                    this.iq = b;
                    break;
                case XamDataLegend.$$p[41]:
                    this.i7 = b;
                    break;
                case "UnitsTextStyle":
                    this.bv = b;
                    break;
                case XamDataLegend.$$p[38]:
                    this.i6 = b;
                    break;
                case XamDataLegend.$$p[37]:
                    this.ip = b;
                    break;
                case "TitleTextStyle":
                    this.bu = b;
                    break;
                case XamDataLegend.$$p[20]:
                    this.ar = EnumUtil.getEnumValue(DataLegendLabelMode_$type, b);
                    break;
                case XamDataLegend.$$p[21]:
                    this.ii = b;
                    break;
                case XamDataLegend.$$p[22]:
                    this.i3 = b;
                    break;
                case "LabelTextStyle":
                    this.bp = b;
                    break;
            }
        }
        a5() {
            return new DataLegendView(this);
        }
        destroy() {
            this.provideContainer(null);
        }
        get externalObject() {
            return this._externalObject;
        }
        set externalObject(a) {
            this._externalObject = a;
        }
        flush() {
            this.a6.av();
        }
        onAttachedToUI() {
            this.a6.a5();
        }
        onDetachedFromUI() {
            this.a6.a8();
        }
        ensureIndirectContainer(a, b) {
            if (this.a6.al == null) {
                this.a6.a6(a, true);
            }
        }
        provideContainer(a) {
            this.a6.a6(a, false);
        }
        gc() {
            if (this.bx) {
                return;
            }
            this.bx = this.a6.aa();
        }
        get shouldOnDemandRender() {
            return this.by;
        }
        set shouldOnDemandRender(a) {
            this.by = a;
        }
        doRender(a, b) {
            if (this.it.isEmpty) {
                let c = this.getDesiredSize();
                this.it = new Rect(0, 0, 0, c.width, c.height);
            }
            this.gd(true);
            this.a6.bb(a, b);
        }
        ensureUpdated() {
            let a = this.getDesiredSize();
        }
        fx() {
            if (!this.bx) {
                if (this.ao == null) {
                    this.gc();
                }
                else {
                    return;
                }
            }
            this.gp();
        }
        getDesiredSize() {
            this.fx();
            if (this.ao == null) {
                return new Size(1, 0, 0);
            }
            return new Size(1, this.ao.d, this.ao.c);
        }
        gp() {
            this.fu();
            if (this.a8 == null || this.a8.isDetached || !this.b3()) {
                return;
            }
            let a = this.a8;
            let b = a.getDataLegendSeries();
            this.fy(b);
            this.fn(b, "");
            this.cj = new List$1(String_$type, 0);
            for (let c of fromEnum(this.cd.keys)) {
                let d = this.cd.item(c);
                this.f1(d);
                for (let e of fromEnum(d.b)) {
                    if (!this.cj.contains(e.h) && !stringContains(e.h, "Highlight") && !stringContains(e.h, "Overlay")) {
                        this.cj.add(e.h);
                    }
                }
            }
            for (let f of fromEnum(this.cd.keys)) {
                let g = this.cd.item(f);
                if (g.c.count > 0) {
                    this.f0(g);
                }
            }
            this.bz = this.b6();
            this.ft(this.ao);
        }
        fy(a) {
            let b = new Dictionary$2(Number_$type, List$1.$.specialize(IDataLegendSeries_$type), 0);
            for (let c = 0; c < a.length; c++) {
                if (a[c].legendItemVisibility != 0) {
                    continue;
                }
                let d = a[c].title == null ? null : a[c].title.toString();
                let e = this.cf == null || this.cf.containsKey(a[c].dataLegendKey) || this.cf.containsKey(a[c].parentKey) || this.cf.containsKey(a[c].parentTitle) || this.cf.containsKey(a[c].index.toString()) || this.cf.containsKey(a[c].group) || this.cf.containsKey(d);
                let f = this.ce != null && (this.ce.containsKey(a[c].dataLegendKey) || this.ce.containsKey(a[c].parentKey) || this.ce.containsKey(a[c].parentTitle) || this.ce.containsKey(a[c].index.toString()) || this.ce.containsKey(a[c].group) || this.ce.containsKey(d));
                if (e && !f) {
                    let g = this.cv(a[c]);
                    if (!b.containsKey(g)) {
                        b.addItem(g, new List$1(IDataLegendSeries_$type, 0));
                    }
                    b.item(g).add(a[c]);
                }
            }
            let h = new List$1(Number_$type, 1, b.keys);
            h.y();
            let i = new List$1(IDataLegendSeries_$type, 0);
            for (let j of fromEnum(h)) {
                for (let k of fromEnum(b.item(j))) {
                    i.add(k);
                }
            }
            this.cd = new Dictionary$2(String_$type, DataLegendSeriesGroupInfo.$, 0);
            for (let l of fromEnum(i)) {
                let m = l.group;
                if (!this.cd.containsKey(m)) {
                    this.cd.addItem(m, ((() => {
                        let $ret = new DataLegendSeriesGroupInfo();
                        $ret.f = m;
                        return $ret;
                    })()));
                }
                this.cd.item(m).c.add(l);
            }
        }
        cv(a) {
            if (this.cf == null) {
                return a.index;
            }
            let b = a.dataLegendKey;
            if (this.cf.containsKey(b)) {
                return this.cf.item(b);
            }
            let c = a.index.toString();
            if (this.cf.containsKey(c)) {
                return this.cf.item(c);
            }
            let d = a.title == null ? null : a.title.toString();
            if (this.cf.containsKey(d)) {
                return this.cf.item(d);
            }
            return a.index;
        }
        fw() {
            this.bx = false;
            if (!this.a6.z) {
                return;
            }
            let a = new Size(1, 0, 0);
            if (this.ao != null) {
                a = new Size(1, this.ao.d, this.ao.c);
            }
            this.gp();
            let b = new Size(1, 0, 0);
            if (this.ao != null) {
                b = new Size(1, this.ao.d, this.ao.c);
            }
            if (!a.equals(b)) {
                this.a6.aq(b.width, b.height);
            }
            this.gd(this.by);
        }
        f2(message_) {
        }
        gd(a) {
            let b = new DataLegendRenderContext();
            for (let c = 0; c < this.ao.b.count; c++) {
                let d = this.ao.b._inner[c];
                this.gf(d, b);
            }
            this.a6.r.count = b.b;
            this.a6.s.count = b.c;
            this.a6.u.count = b.e;
            this.a6.t.count = b.d;
            this.a6.q.count = b.a;
            if (!a) {
                this.a6.au(this.ao);
            }
        }
        gf(a, b) {
            if (a.w.width > 0 && a.w.height > 0 && !a.b && !a.e && !a.a && a.k) {
                let c = this.a6.r.item(b.b);
                b.b += 1;
                this.ge(c, a, b);
            }
            this.a6.bd();
            if (!a.v.isEmpty && a.v.width > 0 && a.v.height > 0) {
                let d = this.a6.s.item(b.c);
                b.c += 1;
                this.gg(d, a.q, a.t, a.j, a.v);
            }
            for (let e of fromEnum(a.l)) {
                if (!e.af.isEmpty && e.r()) {
                    let f = this.a6.u.item(b.e);
                    b.e += 1;
                    this.gg(f, e.y, e.ac, e.j, e.af);
                }
                if (!e.ae.isEmpty && e.p() && e.n) {
                    let g = this.a6.t.item(b.d);
                    b.d += 1;
                    this.gg(g, e.v, e.ab, e.i, e.ae);
                }
                if (!e.ad.isEmpty && e.m() && e.k) {
                    let h = this.a6.q.item(b.a);
                    b.a += 1;
                    this.gg(h, e.u, e.aa, e.h, e.ad);
                }
            }
            this.a6.ar();
        }
        gg(a, b, c, d, e) {
            a.al = b;
            this.a6.bc(a, e.left, e.top);
            this.a6.as(a, d);
            this.a6.at(a, d);
            a.ao = c;
        }
        ge(a, b, c) {
            a.ah = b.s;
            a.content = b.m;
            a.width = b.w.width;
            a.height = b.w.height;
            this.a6.bc(a, b.u.left, b.u.top);
        }
        b1(a, b) {
            if (b == null) {
                return false;
            }
            return a.containsKey(b);
        }
        f1(a) {
            a.a.clear();
            a.b.clear();
            a.d = 0;
            for (let b = 0; b < a.c.count; b++) {
                let c = a.c._inner[b];
                let d = b;
                let e = c.getDataLegendResolvedWorldPositionX(this.co);
                let f = c.getDataLegendResolvedWorldPositionY(this.cp);
                let g = typeCast(DataLegendSeriesContext.$, c.getDataLegendSeriesContextAt(e, f));
                if (g != null) {
                    let h = new List$1(DataLegendSeriesValueInfo.$, 0);
                    for (let i = 0; i < g.e.count; i++) {
                        let j = g.e._inner[i];
                        let k = this.cc == null || this.b1(this.cc, j.r) || this.b1(this.cc, j.q) || this.b1(this.cc, j.s) || this.b1(this.cc, "ALL");
                        let l = this.cb != null && (this.b1(this.cb, j.r) || this.b1(this.cb, j.q) || this.b1(this.cb, j.s) || this.b1(this.cb, "ALL"));
                        let m = this.cc == null && this.cb == null && j.k;
                        if (k && (!l && !m)) {
                            j.o = h.count;
                            h.add(j);
                            if (!a.a.containsKey(j.o)) {
                                a.a.addItem(j.o, new DataLegendColumn());
                            }
                            a.a.item(j.o).i = j.o;
                            a.a.item(j.o).d.q(d, j.t);
                            a.a.item(j.o).b.q(d, j.s);
                            a.a.item(j.o).e.q(d, j.l);
                            a.a.item(j.o).c.q(d, j);
                            a.a.item(j.o).h.add(d);
                        }
                    }
                    g.e = h;
                    a.b.add(g);
                    a.d = Math.max(a.d, g.e.count);
                }
            }
            for (let n of fromEnum(a.a.values)) {
                n.f.clear();
                n.a.clear();
                let o = n.e.p(n.h);
                let p = this.ch(o);
                for (let q = 0; q < p.count; q++) {
                    let r = p._inner[q];
                    let s = n.h._inner[q];
                    n.a.q(s, r);
                    let t = n.c.item(s);
                    let u = this.d8(r, t);
                    n.f.q(s, u);
                    let v = !stringIsNullOrEmpty(r.l);
                    if (v) {
                        n.g = true;
                    }
                }
            }
        }
        f0(a) {
            if (this.cd.count >= 1 && this.b2) {
                this.fp(a.f);
            }
            for (let b = 0; b < a.c.count; b++) {
                this.go(a.c._inner[b], this.a9);
                this.fq(a, b);
            }
            this.fr(a);
        }
        b6() {
            let a = false;
            for (let b = 0; b < this.ao.b.count; b++) {
                let c = this.ao.b._inner[b];
                if (c.d && c.k && c.i != 7) {
                    a = true;
                    break;
                }
            }
            return a;
        }
        ft(a) {
            let b = 0;
            let c = 0;
            for (let d = 0; d < a.b.count; d++) {
                let e = a.b._inner[d];
                this.f3(e);
            }
            let f = 0;
            let g = new Size(1, 0, 0);
            let h = new Size(1, 0, 0);
            let i = new Dictionary$2(Number_$type, Size.$, 0);
            let j = new Dictionary$2(Number_$type, Size.$, 0);
            let k = new Dictionary$2(Number_$type, Size.$, 0);
            for (let l of fromEnum(a.b)) {
                for (let m = 0; m < l.l.count; m++) {
                    let n = l.l._inner[m];
                    if (!i.containsKey(m)) {
                        i.addItem(m, new Size(1, 0, 0));
                    }
                    i.item(m, this.ix(i.item(m), n.al, n.ao));
                    if (!j.containsKey(m)) {
                        j.addItem(m, new Size(1, 0, 0));
                    }
                    j.item(m, this.ix(j.item(m), n.aj, n.an));
                    if (!k.containsKey(m)) {
                        k.addItem(m, new Size(1, 0, 0));
                    }
                    k.item(m, this.ix(k.item(m), n.ah, n.am));
                }
            }
            for (let o = 0; o < a.b.count; o++) {
                let p = a.b._inner[o];
                h = this.iw(h, p.w, p.y);
                g = this.ix(g, p.x, p.aa);
                for (let q = 0; q < p.l.count; q++) {
                    p.l._inner[q].ak = i.item(q);
                    p.l._inner[q].ai = j.item(q);
                    p.l._inner[q].ag = k.item(q);
                }
                if (p.e || p.a) {
                    let r = p.x.width + p.aa.left + p.aa.right;
                    f = Math.max(f, r + p.z.left);
                }
                else if (p.d) {
                    let s = p.x.width + p.aa.left + p.aa.right;
                    let t = p.w.width + p.y.left + p.y.right;
                    f = Math.max(f, s + p.z.left + t);
                }
            }
            let u = 0;
            let v = 0;
            for (let w = 0; w < a.b.count; w++) {
                let x = a.b._inner[w];
                let y = this.iu(v, x, f, g, h);
                v = y.height;
                u = Math.max(u, y.width);
            }
            c = v;
            b = u;
            a.d = b;
            a.c = c;
        }
        iw(a, b, c) {
            return new Size(1, Math.max(a.width, b.width + c.left + c.right), Math.max(a.height, b.height + c.top + c.bottom));
        }
        ix(a, b, c) {
            return new Size(1, Math.max(a.width, b.width + c.left + c.right), Math.max(a.height, b.height + c.top + c.bottom));
        }
        iu(a, b, c, d, e) {
            let f = 0;
            let g = 0;
            g = Math.max(b.w.height, g);
            g = Math.max(b.x.height, g);
            for (let h of fromEnum(b.l)) {
                g = Math.max(h.al.height, g);
                if (h.n) {
                    g = Math.max(h.aj.height, g);
                }
                if (h.k) {
                    g = Math.max(h.ah.height, g);
                }
            }
            f += b.z.left;
            a += b.z.top;
            if (!b.b && !b.e && !b.a && this.bz) {
                f += b.y.left;
                let i = 0;
                if (g > b.w.height) {
                    i = (g - b.w.height) / 2;
                }
                b.u = new Rect(0, f, a + i, b.w.width, b.w.height);
                f += (b.u.width) + b.y.right;
            }
            else {
                b.u = new Rect(0, 0, 0, 0, 0);
            }
            f += b.aa.left;
            let j = 0;
            if (g > b.x.height) {
                j = (g - b.x.height) / 2;
            }
            b.v = new Rect(0, f, a + j, b.x.width + b.aa.right, b.x.height);
            f = Math.max(c, b.v.right);
            for (let k of fromEnum(b.l)) {
                let l = " C=" + k.t + " SR=" + numberToString2(f, "000");
                if ((k.m() && k.k) && k.ag.width > 0) {
                    let m = 0;
                    if (g > k.ah.height) {
                        m = (g - k.ah.height) / 2;
                    }
                    k.ad = new Rect(0, f + k.am.left, a + m, k.ah.width, k.ah.height);
                    f += k.ag.width;
                    l += " label L=" + numberToString2(k.ad.left, "000") + " R=" + numberToString2(k.ad.right, "000");
                }
                if (k.r()) {
                    l += " v MW=" + numberToString2(k.ak.width, "000");
                    f += k.ao.left;
                    f += (k.ak.width - (k.al.width + k.ao.right));
                    let n = 0;
                    if (g > k.al.height) {
                        n = (g - k.al.height) / 2;
                    }
                    k.af = new Rect(0, f, a + n, k.al.width, k.al.height);
                    l += " v ML=" + numberToString2(k.ao.left, "00") + " MR=" + numberToString2(k.ao.right, "00");
                    l += " v BL=" + numberToString2(k.af.left, "000") + " BR=" + numberToString2(k.af.right, "000");
                    f += k.af.width;
                    f += k.ao.right;
                }
                if ((k.p() && k.n) && k.ai.width > 0) {
                    let o = 0;
                    if (g > k.aj.height) {
                        o = (g - k.aj.height) / 2;
                    }
                    k.ae = new Rect(0, f + k.an.left, a + o, k.aj.width, k.aj.height);
                    f += k.ai.width;
                    l += " unit L=" + numberToString2(k.ae.left, "000") + " R=" + numberToString2(k.ae.right, "000");
                }
                this.f2("maxRight " + numberToString2(c, "0") + l);
            }
            f += b.z.right;
            a += g;
            a += b.z.bottom;
            return new Size(1, f, a);
        }
        f3(a) {
            a.x = a.q == null ? new Size(1, 0, 0) : this.a6.bz(a.q, a.j);
            for (let b of fromEnum(a.l)) {
                b.al = b.y == null ? new Size(1, 0, 0) : this.a6.bz(b.y, b.j);
                b.aj = b.v == null ? new Size(1, 0, 0) : this.a6.bz(b.v, b.i);
                b.ah = b.u == null ? new Size(1, 0, 0) : this.a6.bz(b.u, b.h);
            }
        }
        d7(a, b, c, d, e) {
            if (this.a3 == 2) {
                return null;
            }
            let f = "";
            if (stringIsNullOrEmpty(this.ey)) {
                f = c;
            }
            else {
                f = this.ey;
            }
            if (e) {
                if (stringIsNullOrEmpty(f)) {
                    f = d;
                }
                else {
                    f = d + f;
                }
            }
            let g = a.a.item(b).d;
            let h = a.a.item(b).g;
            if (h && stringIsNullOrEmpty(f)) {
                f = " ";
            }
            else if (g.count > 0 && stringIsNullOrEmpty(f)) {
                f = " ";
            }
            else if (!e) {
                return null;
            }
            return f;
        }
        d5(a, b, c, d) {
            if (this.ar == 2) {
                return null;
            }
            let e = a.d > 1;
            let f = this.ar == 1;
            let g = a.a.item(b).b.count > 0;
            if (g && (e || f)) {
                if (stringIsNullOrEmpty(c)) {
                    return " ";
                }
                else if (d) {
                    return c;
                }
            }
            return null;
        }
        fr(a) {
            if (this.a2 == 5) {
                return;
            }
            if (a.c == null || a.c.count <= 1) {
                return;
            }
            let b = new Dictionary$2(Number_$type, DataLegendSummaryColumn.$, 0);
            let c = 0;
            let d = false;
            let e = new List$1(String_$type, 0);
            for (let f of fromEnum(a.b)) {
                c = Math.max(c, f.e.count);
                if (!e.contains(f.h)) {
                    e.add(f.h);
                }
                if (this.a2 == 0) {
                    if (e.count > 1) {
                        return;
                    }
                }
                if (stringContains(f.h, "Geographic") || stringContains(f.h, "Scatter") || stringContains(f.h, "Shape") || stringContains(f.h, "Polar") || stringContains(f.h, "Financial") || stringContains(f.h, "Indicator")) {
                    d = true;
                }
                for (let g = 0; g < f.e.count; g++) {
                    let h = f.e._inner[g];
                    if (!b.containsKey(g)) {
                        b.addItem(g, new DataLegendSummaryColumn());
                    }
                    let i = b.item(g);
                    i.n = h.n;
                    i.m = h.m;
                    i.e = h.e;
                    i.h = h.h;
                    i.f = h.f;
                    i.f = h.g;
                    i.d = h.d;
                    i.z = h.z;
                    i.ak(h.l);
                    i.ai(h.s);
                    i.aj(h.t);
                    if (stringIsNullOrEmpty(i.v)) {
                        i.v = h.v;
                    }
                    if (stringIsNullOrEmpty(i.w)) {
                        i.w = h.w;
                    }
                    if (stringIsNullOrEmpty(i.x)) {
                        i.x = h.x;
                    }
                    if (stringIsNullOrEmpty(i.y)) {
                        i.y = h.y;
                    }
                    if (stringIsNullOrEmpty(i.r)) {
                        i.r = h.r;
                    }
                    if (stringIsNullOrEmpty(i.q)) {
                        i.q = h.q;
                    }
                }
            }
            if (this.a2 == 0) {
                if (d) {
                    return;
                }
                let j = this.cj.count > 1;
                if (j) {
                    return;
                }
                for (let k = 0; k < a.c.count; k++) {
                    let l = a.c._inner[k];
                    if (!l.isSummarizationSupported) {
                        return;
                    }
                }
            }
            let m = this.a7();
            let n = new DataLegendRowInfo(this.a6, true, false, false, -1);
            n.q = this.ef != null ? this.ef : m.title;
            n.t = this.il || n.t;
            n.j = this.br || n.j;
            n.o = a.f;
            for (let o = 0; o < c; o++) {
                let p = b.item(o);
                let q = m.calculate(p.ac, p.r);
                q = this.a1(q);
                let r = this.an;
                let s = r == 0 || r == 2 || r == 8;
                let t = -1;
                for (let u of fromEnum(a.a.item(o).a.values)) {
                    if (u.b()) {
                        t = Math.max(t, u.h);
                        if (s) {
                            r = u.a;
                        }
                    }
                }
                let v = this.cx >= 0 ? this.cx : t;
                let w = this.cw >= 0 ? this.cw : t;
                let x = this.am(q.c, r, v, w);
                x.i = v;
                x.h = w;
                let y = this.d8(x, p);
                let z = new DataLegendRowCell(this.a6, true, false, false, -1);
                z.t = n.l.count;
                z.u = this.d5(a, z.t, " ", p.b);
                if (!stringIsNullOrEmpty(this.ea)) {
                    z.u = this.ea;
                }
                if (q.e != null) {
                    z.u = q.e;
                }
                z.k = !stringIsNullOrEmpty(z.u);
                z.aa = this.ik || z.aa;
                z.h = this.bq || z.h;
                z.y = y;
                z.j = this.bt || z.j;
                z.ac = this.ij(this.io, z.ac, null);
                z.s = q.c;
                z.g = x.a;
                z.x = p.r;
                z.w = p.q;
                let aa = p.ab.length >= 1 ? p.ab[0] : " ";
                z.v = this.d7(a, z.t, aa, x.l, p.d);
                if (q.f != null) {
                    z.v = q.f;
                }
                z.n = !stringIsNullOrEmpty(z.v);
                z.ab = this.im || z.ab;
                z.i = this.bs || z.i;
                n.l.add(z);
            }
            this.gm(n);
            if (n.c) {
                this.fs(n);
                this.f9(n);
                this.ao.e(n);
            }
        }
        am(a, b, c, d) {
            if (b == 8 || b == 0) {
                b = this.an;
            }
            if (d < 0) {
                d = this.cw;
            }
            if (c < 0) {
                c = this.cx;
            }
            return DataAbbreviator.a(a, b, c, d);
        }
        ct(a, b, c, d) {
            return this.am(a, b, c, d).d;
        }
        da(a, b, c, d) {
            return this.am(a, b, c, d).l;
        }
        c9(a, b, c, d) {
            let e = this.am(a, b, c, d);
            return e.m + e.l;
        }
        ch(a) {
            let b = this.cx;
            let c = this.cw;
            let d = this.an;
            let e = DataAbbreviator.h(a, d, b, c);
            return e;
        }
        ci(a, b) {
            let c = new List$1(Number_$type, 0);
            if (b < 0) {
                return c;
            }
            for (let d = 0; d < a.b.count; d++) {
                let e = a.b._inner[d];
                if (e.e.count > b) {
                    let f = e.e._inner[b].l;
                    if (!isNaN_(f)) {
                        c.add(f);
                    }
                }
            }
            return c;
        }
        fs(a) {
        }
        ij(a, b, c) {
            if (a != null) {
                return a;
            }
            if (this.ca && c != null) {
                return c;
            }
            return b;
        }
        d6(a, b) {
            return stringIsNullOrEmpty(a) ? b : a;
        }
        d8(a, b) {
            let c = a.d;
            if (b == null || isNaN_(c) || isInfinity(c)) {
                return this.fl;
            }
            let d;
            let e = b.d ? a.d : a.g;
            if (this.ak != null) {
                d = this.ak.i(e);
            }
            else {
                let f = this.a4;
                if (f == 0) {
                    f = 1;
                }
                let g = new NumberFormatSpecifier();
                g.useGrouping = this.b8;
                g.locale = this.d6(this.e4, null);
                g.currencyCode = this.e6;
                if (b.d) {
                    g.minimumFractionDigits = a.i;
                    g.maximumFractionDigits = a.h;
                    if (b.n >= 0 && b.n > a.i) {
                        g.minimumFractionDigits = b.n;
                    }
                    else if (this.cx >= 0) {
                        g.minimumFractionDigits = this.cx;
                    }
                    if (b.m >= 0 && b.m > a.h) {
                        g.maximumFractionDigits = b.m;
                    }
                    else if (this.cw >= 0) {
                        g.maximumFractionDigits = this.cw;
                    }
                }
                else {
                    g.minimumFractionDigits = b.n;
                    g.maximumFractionDigits = b.m;
                }
                if (g.minimumFractionDigits > g.maximumFractionDigits) {
                    g.maximumFractionDigits = g.minimumFractionDigits;
                }
                if (f == 2 && b.e) {
                    g.style = "currency";
                }
                if (this.al == null) {
                    this.al = new BindingFormatter();
                }
                this.al.j = "{0}";
                this.al.d = [g];
                d = this.al.i(e);
                if (e > 0) {
                    d = b.x + d;
                }
                else if (e < 0) {
                    d = b.v + d;
                }
                if (e >= 0) {
                    d += b.y;
                }
                else {
                    d += b.w;
                }
            }
            return d;
        }
        fq(a, b) {
            if (this.b9 == false) {
                return;
            }
            let c = a.b._inner[b];
            let d = a.c._inner[b];
            let e = d.getDataLegendSeriesTitle();
            let f = new DataLegendRowInfo(this.a6, false, false, false, b);
            f.g = c.a();
            f.p = e;
            f.o = a.f;
            f.q = e;
            f.t = this.ip || f.t;
            f.j = this.bu || f.j;
            for (let g = 0; g < c.e.count; g++) {
                let h = c.e._inner[g];
                let i = a.a.item(g).a.item(b);
                let j = a.a.item(g).f.item(b);
                let k = new DataLegendRowCell(this.a6, false, false, false, b);
                k.t = f.l.count;
                k.j = this.bw || k.j;
                k.y = j;
                k.ac = this.ij(this.ir, k.ac, h.z);
                k.x = h.r;
                k.w = h.q;
                k.s = h.l;
                k.g = i.a;
                k.v = this.d7(a, k.t, h.t, i.l, h.d);
                k.n = !stringIsNullOrEmpty(k.v);
                k.ab = this.iq || k.ab;
                k.i = this.bv || k.i;
                k.u = this.d5(a, k.t, h.s, h.b);
                k.k = !stringIsNullOrEmpty(k.u);
                k.aa = this.ii || k.aa;
                k.h = this.bp || k.h;
                f.l.add(k);
            }
            f.i = this.ba(d);
            f.n = d.getDataLegendBadgeShapeAndMarker();
            this.fs(f);
            this.f9(f);
            this.gl(f);
            if (f.c) {
                if (f.k) {
                    this.go(d, f.i);
                    let l = this.gs(d);
                    let m = this.cz(d);
                    f.s = l;
                    f.m = m;
                }
                this.ao.e(f);
            }
        }
        cz(a) {
            return a.getDataLegendBadgeContext();
        }
        ba(a) {
            if (this.a9 != 0) {
                return this.a9;
            }
            return a.legendItemBadgeShape;
        }
        go(a, b) {
            if (b == 0) {
                return;
            }
            if (a.legendItemBadgeShape != b) {
                a.legendItemBadgeShape = b;
            }
        }
        b3() {
            return !isNaN_(this.co) && !isNaN_(this.cp);
        }
        gs(a) {
            return a.getDataLegendBadge();
        }
        fn(a, b) {
            if (this.b4 == false) {
                return;
            }
            let c = this.d4(a);
            if (c == null) {
                c = this.c0;
            }
            else {
                this.c0 = c;
            }
            if (stringIsNullOrEmpty(c)) {
                return;
            }
            let d = new DataLegendRowInfo(this.a6, false, true, false, -1);
            d.q = c;
            d.t = this.ih || d.t;
            d.j = this.bo || d.j;
            d.o = b;
            this.fs(d);
            this.f9(d);
            this.gk(d);
            if (d.c) {
                this.ao.e(d);
            }
        }
        fp(a) {
            if (stringIsNullOrEmpty(a)) {
                return;
            }
            let b = new DataLegendRowInfo(this.a6, false, false, true, -1);
            b.q = a;
            b.t = this.ig || b.t;
            b.j = this.bn || b.j;
            b.o = a;
            this.fs(b);
            this.f9(b);
            this.gj(b);
            if (b.c) {
                this.ao.e(b);
            }
        }
        i8(a) {
            let b = new Thickness(0, 0);
            if (a.top >= 0) {
                b.top = a.top;
            }
            if (a.bottom >= 0) {
                b.bottom = a.bottom;
            }
            if (a.left >= 0) {
                b.left = a.left;
            }
            if (a.right >= 0) {
                b.right = a.right;
            }
            return b;
        }
        f9(a) {
            if (a.d) {
                a.aa = this.i8(this.i6);
                a.z = this.i8(this.i9);
            }
            else if (a.b) {
                a.aa = this.i8(this.i2);
                a.z = this.i8(this.i1);
            }
            else if (a.a) {
                a.aa = this.i8(this.i0);
                a.z = this.i8(this.iz);
            }
            else {
                a.aa = this.i8(this.i5);
                a.z = this.i8(this.i4);
            }
            for (let b of fromEnum(a.l)) {
                b.ao = this.i8(this.ja);
                b.an = this.i8(this.i7);
                b.am = this.i8(this.i3);
            }
            if (a.d) {
                a.y = this.i8(this.iy);
                a.w = new Size(1, 20, 15);
            }
        }
        d4(a) {
            if (this.dq != null) {
                return this.dq;
            }
            let b = true;
            let c = null;
            for (let d = 0; d < a.length; d++) {
                let e = a[d];
                let f = this.d2(e);
                if (f == null) {
                    continue;
                }
                if (c == null) {
                    c = f;
                }
                else {
                    if (!Base.equalsStatic(c, f)) {
                        b = false;
                        break;
                    }
                }
            }
            if (b || !stringIsNullOrEmpty(c)) {
                return c;
            }
            return null;
        }
        d2(a) {
            if (this.b3()) {
                let b = a.getDataLegendAxisLabelFromCursorPosition(this.co, this.cp);
                if (typeCast(Date_$type, b) !== null) {
                    let c = b;
                    b = this.d3(c);
                }
                return b == null ? "" : b.toString();
            }
            else {
                return null;
            }
        }
        d3(a) {
            if (this.ai != null) {
                let b = this.ai.i(a);
                return b;
            }
            else {
                let c = new DateTimeFormatSpecifier();
                c.dateStyle = "short";
                c.timeStyle = "full";
                let d = this.ap;
                if (d == 0) {
                    d = 1;
                }
                if (d == 3) {
                    c.dateStyle = "medium";
                }
                if (d == 1) {
                    c.dateStyle = "short";
                }
                if (d == 4) {
                    c.dateStyle = "full";
                }
                if (d == 2) {
                    c.dateStyle = "long";
                }
                if (d == 5) {
                    c.dateStyle = null;
                }
                let e = this.aq;
                if (e == 0) {
                    e = 1;
                }
                if (e == 3) {
                    c.timeStyle = "medium";
                }
                if (e == 1) {
                    c.timeStyle = "short";
                }
                if (e == 4) {
                    c.timeStyle = "full";
                }
                if (e == 2) {
                    c.timeStyle = "long";
                }
                if (e == 5) {
                    c.timeStyle = null;
                }
                c.locale = this.d6(this.dg, "en-US");
                if (this.aj == null) {
                    this.aj = new BindingFormatter();
                }
                this.aj.j = "{0}";
                this.aj.d = [c];
                let f = this.aj.i(a);
                return f;
            }
        }
        fu() {
            if (this.ao != null) {
                this.ao.f();
            }
        }
    }
    XamDataLegend.$t = /*@__PURE__*/ markType(XamDataLegend, 'XamDataLegend', Control.$, [INotifyPropertyChanged_$type, IDataLegend_$type, IOnDemandRender_$type]);
    XamDataLegend.$$p = /*@__PURE__*/ markDep(DependencyProperty, PropertyMetadata, XamDataLegend, 'f7', ['BadgeMargin:iy:gt', [Thickness.$, /*@__PURE__*/ new Thickness(1, 0, 0, 0, 0)], 'BadgeShape:a9:gu', [LegendItemBadgeShape_$type, /*@__PURE__*/ enumGetBox(LegendItemBadgeShape_$type, 0)], 'ExcludedColumns::gv', [Array_$type, null], 'ExcludedSeries::gw', [Array_$type, null], 'GroupRowMargin:iz:gx', [Thickness.$, /*@__PURE__*/ new Thickness(0, 5)], 'GroupRowVisible:b2:gy', [0, false], 'GroupTextColor:ig:gz', [Brush.$, null], 'GroupTextMargin:i0:g0', [Thickness.$, /*@__PURE__*/ new Thickness(1, 2, 0, 0, 0)], 'HeaderFormatCulture:dg:g1', [2, /*@__PURE__*/ stringEmpty()], 'HeaderFormatDate:ap:g2', [DataLegendHeaderDateMode_$type, /*@__PURE__*/ enumGetBox(DataLegendHeaderDateMode_$type, 0)], 'HeaderFormatSpecifiers:ag:g3', [Array_$type, null], 'HeaderFormatString:dk:g4', [2, null], 'HeaderFormatTime:aq:g5', [DataLegendHeaderTimeMode_$type, /*@__PURE__*/ enumGetBox(DataLegendHeaderTimeMode_$type, 0)], 'HeaderRowMargin:i1:g6', [Thickness.$, /*@__PURE__*/ new Thickness(0, 5)], 'HeaderRowVisible:b4:g7', [0, true], 'HeaderTextColor:ih:g8', [Brush.$, null], 'HeaderTextMargin:i2:g9', [Thickness.$, /*@__PURE__*/ new Thickness(1, 2, 0, 0, 0)], 'HeaderText:dq:ha', [2, null], 'IncludedColumns::hb', [Array_$type, null], 'IncludedSeries::hc', [Array_$type, null], 'LabelDisplayMode:ar:hd', [DataLegendLabelMode_$type, /*@__PURE__*/ enumGetBox(DataLegendLabelMode_$type, 0)], 'LabelTextColor:ii:he', [Brush.$, null], 'LabelTextMargin:i3:hf', [Thickness.$, /*@__PURE__*/ new Thickness(1, 12, 0, 0, 0)], 'ShouldUpdateWhenSeriesDataChanges:b7:hg', [0, true], 'SummaryLabelTextColor:ik:hh', [Brush.$, null], 'SummaryLabelText:ea:hi', [2, null], 'SummaryRowMargin:i4:hj', [Thickness.$, /*@__PURE__*/ new Thickness(0, 5)], 'SummaryTitleTextColor:il:hk', [Brush.$, null], 'SummaryTitleTextMargin:i5:hl', [Thickness.$, /*@__PURE__*/ new Thickness(1, 2, 0, 4, 0)], 'SummaryTitleText:ef:hm', [2, null], 'SummaryType:a2:hn', [DataLegendSummaryType_$type, /*@__PURE__*/ enumGetBox(DataLegendSummaryType_$type, 0)], 'SummaryUnitsTextColor:im:ho', [Brush.$, null], 'SummaryUnitsText:el:hp', [2, null], 'SummaryValueTextColor:io:hq', [Brush.$, null], 'TargetCursorPositionX::hr', [1, NaN], 'TargetCursorPositionY::hs', [1, NaN], 'Target::ht', [4, null], 'TitleTextColor:ip:hu', [Brush.$, null], 'TitleTextMargin:i6:hv', [Thickness.$, /*@__PURE__*/ new Thickness(1, 0, 0, 4, 0)], 'UnitsDisplayMode:a3:hw', [DataLegendUnitsMode_$type, /*@__PURE__*/ enumGetBox(DataLegendUnitsMode_$type, 0)], 'UnitsTextColor:iq:hx', [Brush.$, null], 'UnitsTextMargin:i7:hy', [Thickness.$, /*@__PURE__*/ new Thickness(1, 0, 0, 0, 0)], 'UnitsText:ey:hz', [2, null], 'ValueFormatAbbreviation:an:h0', [DataAbbreviationMode_$type, /*@__PURE__*/ enumGetBox(DataAbbreviationMode_$type, 0)], 'ValueFormatCulture:e4:h1', [2, /*@__PURE__*/ stringEmpty()], 'ValueFormatCurrencyCode:e6:h2', [2, null], 'ValueFormatMaxFractions:cw:h3', [1, -1], 'ValueFormatMinFractions:cx:h4', [1, -1], 'ValueFormatMode:a4:h5', [DataLegendValueMode_$type, /*@__PURE__*/ enumGetBox(DataLegendValueMode_$type, 0)], 'ValueFormatSpecifiers:ah:h6', [Array_$type, null], 'ValueFormatString:fc:h7', [2, null], 'ValueFormatUseGrouping:b8:h8', [0, true], 'ValueRowMargin:i9:h9', [Thickness.$, /*@__PURE__*/ new Thickness(0, 5)], 'ValueRowVisible:b9:ia', [0, true], 'ValueTextColor:ir:ib', [Brush.$, null], 'ValueTextMargin:ja:ic', [Thickness.$, /*@__PURE__*/ new Thickness(1, 2, 0, 2, 0)], 'ValueTextUseSeriesColors:ca:id', [0, false], 'ValueTextWhenMissingData:fl:ie', [2, "N/A"]]);
    return XamDataLegend;
})();
/**
 * @hidden
 */
export let DataLegendView = /*@__PURE__*/ (() => {
    class DataLegendView extends Base {
        constructor(a) {
            super();
            this.ad = null;
            this.af = null;
            this.ah = null;
            this.ag = null;
            this.ae = null;
            this.q = null;
            this.s = null;
            this.u = null;
            this.t = null;
            this.r = null;
            this.a = null;
            this.am = null;
            this.al = null;
            this.v = null;
            this.b = null;
            this.ai = 1;
            this.y = false;
            this.ao = -1;
            this.an = -1;
            this.ab = new Dictionary$2(FontInfo.$, Tuple$2.$.specialize(Number_$type, FontInfo.$), 0);
            this.x = false;
            this.ac = new List$1(FrameworkElement.$, 0);
            this.aj = 0;
            this.g = null;
            this.i = null;
            this.h = null;
            this.e = null;
            this.f = null;
            this.d = null;
            this.c = null;
            this.w = null;
            this.a = a;
            this.s = ((() => {
                let $ret = new Pool$1(TextBlock.$);
                $ret.create = runOn(this, this.bp);
                $ret.activate = runOn(this, this.be);
                $ret.disactivate = runOn(this, this.bg);
                $ret.destroy = runOn(this, this.bf);
                return $ret;
            })());
            this.u = ((() => {
                let $ret = new Pool$1(TextBlock.$);
                $ret.create = runOn(this, this.br);
                $ret.activate = runOn(this, this.bk);
                $ret.disactivate = runOn(this, this.bm);
                $ret.destroy = runOn(this, this.bl);
                return $ret;
            })());
            this.t = ((() => {
                let $ret = new Pool$1(TextBlock.$);
                $ret.create = runOn(this, this.bq);
                $ret.activate = runOn(this, this.bh);
                $ret.disactivate = runOn(this, this.bj);
                $ret.destroy = runOn(this, this.bi);
                return $ret;
            })());
            this.r = ((() => {
                let $ret = new Pool$1(ContentControl.$);
                $ret.create = runOn(this, this.bn);
                $ret.activate = runOn(this, this.a2);
                $ret.disactivate = runOn(this, this.a4);
                $ret.destroy = runOn(this, this.a3);
                return $ret;
            })());
            this.q = ((() => {
                let $ret = new Pool$1(TextBlock.$);
                $ret.create = runOn(this, this.bo);
                $ret.activate = runOn(this, this.az);
                $ret.disactivate = runOn(this, this.a1);
                $ret.destroy = runOn(this, this.a0);
                return $ret;
            })());
            this.ad = new List$1(TextBlock.$, 0);
            this.af = new List$1(TextBlock.$, 0);
            this.ah = new List$1(TextBlock.$, 0);
            this.ag = new List$1(TextBlock.$, 0);
            this.ae = new List$1(ContentControl.$, 0);
        }
        av() {
            this.a.fw();
        }
        bp() {
            let a = new TextBlock();
            this.af.add(a);
            return a;
        }
        be(a) {
            a._visibility = 0;
        }
        bg(a) {
            a._visibility = 1;
        }
        bf(a) {
            this.af.remove(a);
        }
        br() {
            let a = new TextBlock();
            this.ah.add(a);
            return a;
        }
        bk(a) {
            a._visibility = 0;
        }
        bm(a) {
            a._visibility = 1;
        }
        bl(a) {
            this.ah.remove(a);
        }
        bq() {
            let a = new TextBlock();
            this.ag.add(a);
            return a;
        }
        bh(a) {
            a._visibility = 0;
        }
        bj(a) {
            a._visibility = 1;
        }
        bi(a) {
            this.ag.remove(a);
        }
        bo() {
            let a = new TextBlock();
            this.ad.add(a);
            return a;
        }
        az(a) {
            a._visibility = 0;
        }
        a1(a) {
            a._visibility = 1;
        }
        a0(a) {
            this.ad.remove(a);
        }
        bn() {
            let a = new ContentControl();
            this.ae.add(a);
            return a;
        }
        a2(a) {
            a._visibility = 0;
        }
        a4(a) {
            a._visibility = 1;
        }
        a3(a) {
        }
        ay() {
            let a = this.a.pixelScalingRatio;
            let b = this.a.cq;
            if (!isNaN_(a) && a != 0) {
                return;
            }
            if (window.devicePixelRatio != undefined && window.devicePixelRatio != b) {
                this.a.cq = window.devicePixelRatio;
            }
        }
        a7() {
            this.ay();
            let a = Math.round(this.al.rootWrapper.width());
            let b = Math.round(this.al.rootWrapper.height());
            this.a.it = new Rect(0, 0, 0, a, b);
            if (this.b != null) {
                this.b.bl = this.a.it;
            }
            this.a.gc();
        }
        ap() {
            if (this.b != null) {
                this.b.ao = null;
                this.b.av();
                this.b = null;
            }
        }
        get z() {
            return this.al != null;
        }
        a6(a, b) {
            if (a == null) {
                this.am = null;
                this.al = null;
                this.v = null;
                this.ap();
                return;
            }
            this.ai = (isNaN_(this.a.pixelScalingRatio) ? this.a.cq : this.a.pixelScalingRatio);
            let c = a;
            this.al = c;
            let d = this.ai;
            let e = Math.round(c.rootWrapper.width());
            let f = Math.round(c.rootWrapper.height());
            let g = e * d;
            let h = f * d;
            this.al.rootWrapper.setStyleProperty("position", "relative");
            let i = this.al.createElement("canvas");
            i.setStyleProperty("position", "absolute");
            this.al.append(i);
            this.ao = truncate(Math.round(g));
            this.an = truncate(Math.round(h));
            i.setAttribute("width", g.toString());
            i.setAttribute("height", h.toString());
            i.setStyleProperty("width", e.toString() + "px");
            i.setStyleProperty("height", f.toString() + "px");
            this.a.it = new Rect(0, 0, 0, e, f);
            this.am = i;
            let j = this.al.get2DCanvasContext(this.am);
            this.v = new RenderingContext(new CanvasViewRenderer(), j);
            this.ap();
            if (TypeRegistrar.isRegistered("CanvasGestureDOMEventProxy")) {
                this.b = typeCast(EventProxy.$, TypeRegistrar.create("CanvasGestureDOMEventProxy", this.al.rootWrapper, this.al, false));
            }
            if (this.b != null) {
            }
        }
        ax(a, b) {
            this.a7();
        }
        aw(a) {
        }
        ba() {
            let a = this.a.it.width;
            let b = this.a.it.height;
            let c = Math.round(a * this.ai);
            let d = Math.round(b * this.ai);
            if (this.ao != c || this.an != d) {
                this.am.setAttribute("width", c.toString());
                this.am.setAttribute("height", d.toString());
                this.am.setStyleProperty("width", a.toString() + "px");
                this.am.setStyleProperty("height", b.toString() + "px");
                this.ao = truncate(Math.round(c));
                this.an = truncate(Math.round(d));
            }
            this.bb(this.v, this.ai);
        }
        bb(a, b) {
            if (this.v == null) {
                this.y = true;
                this.v = a;
            }
            if (a.d && b != 1) {
                a.aa();
                a.ab(b, b);
            }
            if (a == this.v) {
                if (!a.e) {
                    a.l(this.a.it.left, this.a.it.top, this.a.it.width, this.a.it.height);
                }
            }
            let c = new DataTemplatePassInfo();
            c.passID = "LegendItem";
            for (let d = 0; d < this.ae.count; d++) {
                let e = this.ae._inner[d];
                if (e == null) {
                    continue;
                }
                let f = e.ah;
                if (f == null) {
                    continue;
                }
                let g = new DataTemplateMeasureInfo();
                g.passInfo = c;
                g.context = this.v.h();
                g.width = e.width;
                g.height = e.height;
                g.data = e.content;
                g.renderContext = a;
                f.measure(g);
                let h = new DataTemplateRenderInfo();
                h.availableWidth = e.width;
                h.availableHeight = e.height;
                h.passInfo = c;
                h.context = a.h();
                h.renderContext = a;
                h.data = e.content;
                h.xPosition = e.n;
                h.yPosition = e.o;
                a.aa();
                a.ag(e.n, e.o);
                f.render(h);
                a.z();
            }
            for (let i = 0; i < this.af.count; i++) {
                let j = this.af._inner[i];
                a.ad(j.dataContext);
                a.x(j);
            }
            for (let k = 0; k < this.ad.count; k++) {
                let l = this.ad._inner[k];
                a.ad(l.dataContext);
                a.x(l);
            }
            for (let m = 0; m < this.ah.count; m++) {
                let n = this.ah._inner[m];
                a.ad(n.dataContext);
                a.x(n);
            }
            for (let o = 0; o < this.ag.count; o++) {
                let p = this.ag._inner[o];
                a.ad(p.dataContext);
                a.x(p);
            }
            if (a.d && b != 1) {
                a.z();
            }
        }
        aa() {
            if (this.al != null) {
                this.al.setTimeout(runOn(this.a, this.a.fw), 0);
                return true;
            }
            return false;
        }
        bz(a, b) {
            this.v.ad(b);
            let c = new TextBlock();
            c.al = a;
            let d = this.v.ah(c, this.ak(b), true);
            return new Size(1, d.c, d.b);
        }
        ak(a) {
            if (this.ab.containsKey(a)) {
                let b = this.ab.item(a);
                if (b.d.j == a.j) {
                    return b.c;
                }
            }
            let c = FontUtil.getCurrentFontHeight(this.al, a);
            let d = new Tuple$2(Number_$type, FontInfo.$, c, a);
            this.ab.item(a, d);
            return c;
        }
        bc(a, b, c) {
            if (this.x) {
                this.ac.add(a);
            }
            a.n = b;
            a.o = c;
        }
        au(a) {
            this.ba();
        }
        as(a, b) {
            a.dataContext = b;
        }
        by() {
            return FontDefaults.dataLegendFontBrush;
        }
        bw() {
            return FontDefaults.dataLegendFontBrush;
        }
        bx() {
            return FontDefaults.dataLegendFontBrush;
        }
        bu() {
            return FontDefaults.dataLegendFontBrush;
        }
        bv() {
            return FontDefaults.dataLegendFontBrush;
        }
        bt() {
            return FontDefaults.dataLegendFontBrush;
        }
        bs() {
            return FontDefaults.dataLegendFontBrush;
        }
        n() {
            if (this.g == null) {
                this.g = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.g;
        }
        p() {
            if (this.i == null) {
                this.i = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.i;
        }
        o() {
            if (this.h == null) {
                this.h = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.h;
        }
        l() {
            if (this.e == null) {
                this.e = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.e;
        }
        m() {
            if (this.f == null) {
                this.f = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.f;
        }
        k() {
            if (this.d == null) {
                this.d = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendHeaderFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.d;
        }
        j() {
            if (this.c == null) {
                this.c = ((() => {
                    let $ret = new FontInfo();
                    $ret.q = FontDefaults.dataLegendFontFamily;
                    $ret.f = FontDefaults.dataLegendFontSize;
                    $ret.t = FontDefaults.dataLegendFontStyle;
                    $ret.v = FontDefaults.dataLegendFontWeight;
                    $ret.r = FontDefaults.dataLegendFontStretch;
                    $ret.u = FontDefaults.dataLegendFontVariant;
                    return $ret;
                })());
            }
            return this.c;
        }
        aq(a, b) {
            let model_ = this.a;
            let ext_ = model_.externalObject;
            if (ext_ != null) {
                let width_ = a;
                let height_ = b;
                this.al.rootWrapper.setStyleProperty("min-height", b + "px");
                this.al.rootWrapper.setStyleProperty("min-width", a + "px");
                this.a.notifySizeChanged();
            }
        }
        a9(a) {
            this.ai = a;
        }
        a5() {
            if (this.b != null) {
                let a = this.al.rootWrapper;
                this.b.at(a, "");
            }
        }
        a8() {
            if (this.b != null) {
                let a = this.al.rootWrapper;
                this.b.bh(a, "");
            }
        }
        at(a, b) {
            a.ag = true;
            let c = this.v.ah(a, this.ak(b), true);
        }
        bd() {
            this.ac.clear();
            this.x = true;
            this.aj = 0;
        }
        ar() {
            for (let a = 0; a < this.ac.count; a++) {
                this.aj = Math.max(this.aj, this.ac._inner[a].ah);
            }
            if (this.aj > 0) {
                for (let b = 0; b < this.ac.count; b++) {
                    this.ac._inner[b].ah = this.aj;
                }
            }
            this.x = false;
            this.aj = 0;
        }
    }
    DataLegendView.$t = /*@__PURE__*/ markType(DataLegendView, 'DataLegendView');
    return DataLegendView;
})();
